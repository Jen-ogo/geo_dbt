version: 2

models:
  - name: fact_tomtom_ev_availability_snapshots
    description: "Snapshots of EV availability by station/connector over time."
    tests:
      - not_empty
      - rowcount_gt_0

    columns:
      - name: TOMTOM_POI_ID
        tests:
          - not_null

      - name: CHARGING_AVAILABILITY_ID
        tests:
          - not_null

      - name: UPDATED_AT
        tests:
          - dbt_utils.expression_is_true:
              xpression: "UPDATED_AT is null OR (try_to_timestamp_ntz(UPDATED_AT) is not null)"